---
layout: post
title: 计算机软件与硬件结合部分的构造是怎样的
categories: []
tags: []
published: False
date: 2015-01-04 13:29:25
---

本文是为回答知乎的问题：「[计算机软件与硬件结合部分的构造是怎样的](http://www.zhihu.com/question/26965439/answer/34724110)」而作。

原文问题如下：

> **计算机软件与硬件结合部分的构造是怎样的？**

> 很多人都知道软件编程可以控制硬件电路，尤其是做嵌入式开发的朋友，但是软件是一个无形的代码，而硬件是机械的动作，像是灯光亮起、马达变速等，即使是底层代码像汇编，毕竟也是软件。那这个软件的怎么控制晶体管的呢？软件和硬件结合的部分在哪里呢？困扰了好久的问题了，谢谢

答案如下：

很久没有答题了其实最近真的很忙但是难得今天下午有点空又不想干正事那就上来随便说两句好了可以预见到这会是一个挺长的答案但是我还是忍不住啊我到底是怎么了这样真的好么……

-----这是现在很流行的分割线-----

-----虽然我也不知道为什么这东西会流行起来-----

-----但是过了这条线以后我就会严肃起来------

这个回答对于一些基本的概念，比如什么是编码，什么是晶体管，什么是基本的计算机组成等，将不会做具体解释。如果有朋友不明白的话，那就……去买两本微机原理之类的书看看吧。

好了，现在开始。我们就用一台普通的电脑当例子来说好了，别的电子系统大同小异，原理都是差不多的。

大家都知道，任何软件都是0和1的编码。这些编码平时是存储在那些断电后信息也不会消失的存储器上的，比如磁带，机械式硬盘，亦或是现在正逐渐普及的闪存（Flash Memory）式固态硬盘。闪存里存的是电子，而磁带和机械硬盘里存储的磁极。

![SLC vs. MLC: An Analysis of Flash Memory](https://pic2.zhimg.com/4a2e3506c4c533315ab2dc25cbd77cfd_b.jpg)

![Imec Advances NAND Flash Technology with Ultra-Thin Hybrid Floating Gate Cell](https://pic1.zhimg.com/3f23365dc1811be326a3895e5b49862c_b.jpg)

图1: 闪存（Flash Memory）存储示意图。图片来源：（上）[SLC vs. MLC: An Analysis of Flash Memory](http://www.oempcworld.com/support/SLC_vs_MLC.htm)，（下）[Imec Advances NAND Flash Technology with Ultra-Thin Hybrid Floating Gate Cell](http://www.azom.com/news.aspx?newsID=35085)

以图1中的闪存为例（电子比磁极的概念容易懂一点，这里就用电子做例子了），一个闪存单元可以理解为一个普通的晶体管加上一层很薄的悬浮栅（Floating Gate），这层很薄的悬浮栅可以存储一定量的电子（Electron）。当我们把程序写入或者删除的时候，其实我们就是在把电子注入或者拉出这层悬浮栅。而这层悬浮栅里面有或者没有电子，就会影响这个晶体管本身的开关电压。浅显的说，如果这层悬浮栅里没有电子，那么我们只要在Gate上加3v的电压就能让晶体管Source端的电子流到Drain端；如果这层悬浮栅里面有电子，那我们需要在Gate上加5v的电压才能让Source的电子流到Drain端。有了这个特性，我们就可以定义加3v电压的时候，Drain端有电流流出为1，没有电流流出为0。根据这样的定义，如果我们把很多很多这样的闪存单元排列在一起（图2），统一在他们的Gate上加一个3v大小的电压，然后在他们的Drain端接一根导线测量一下电流，我们就可以发现有的导线上有电流，有的导线上没有电流。一个闪存单元可以做的很小（目前是十几纳米，图1下），这样就可以在很小的空间里存下很多0和1了。

![超级简易电路图](https://pic2.zhimg.com/62fd6421bd7b3e6e642552bcc5a7ac75_b.jpg)
图2，闪存里读出的电流有无可以控制灯泡的开关。

好了，目前其实我们已经把0和1从我们的存储器里面读出来了。现在存储单元里的0和1已经变成了导线上电流的有无。剩下的事情就很简单了。在最极端简化的情况下，我们可以用一个电流放大器直接把这个电流放大，然后接在一个灯泡上，这样我们就可以有一组有亮有暗的灯泡了（图2）。如果我们每隔一段时间更换一下驱动这些灯泡的导线，也就是读出不同的0和1值，那我们就可以得到一组不断变换明暗的灯泡了。如果我们再细致一点，把这些灯泡变得比芝麻粒还小，并且均匀的排列成一个1024x768的阵列，那我们就得到一个可以显示黑白图像的显示器了——前提是要在之前提到的闪存单元里存储进你要显示图像的01信息（记住，电脑里所有信息都是0和1的编码，图像也不例外）。

当然在实际产品的电路中，电流（也就是电子）的传递路径远远没有这么简单。从存储单元读出的电流（电子）会经过无数的临时存储单元，比如静态随机存取存储器，动态随机存储器；无数的算数逻辑单元；无数的传输线路，比如SPI总线，PCI Express，藍牙，最后达到满足需求的逻辑，时序和电流电压大小，从而驱动形形色色的物理部件，比如显示器，马达，喇叭等等。所有这些电流驱动的部件，只要信号端的电子根据事先设计好的顺序和数量到达，就能够发挥出他们的设计功能。

综上，目前主流的电子器件，虽然种类繁多，但归根结底，其承载信息的比特流，是由电子的流动和存储来完成的（比较常见的例外是光纤，那里面跑的是光子，不是电子）。

![打孔纸带](https://pic1.zhimg.com/1a6ed262596bb924c06aee6567a4650c_b.jpg)

图3：早期计算机输入程序用的打孔纸带。图片来源不明。

补充，题主有问电平是怎么跑到闪存单元里面去的，答案是：用另一个程序控制电路把电子打进去的。当然有人又会问这另一个程序是怎么来的，好像变成鸡生蛋蛋生鸡的问题了？其实不是啦，就好像 @陆昊天 答案里提到的，最早的程序比特流都是打在纸带上的（图3），然后机器们就一直进化知道现在可以用很少的电子就能起到当初纸带上的孔一样的作用啦。当然，在逻辑上，纸带上的孔和闪存单元里的电子是等价的。是无数工程师科学家的智慧结晶发明出的各种奇巧装置让现在的我们可以把简单的0和1存放在如此小的空间里面并且能够自由读写。

-----又是流行的分割线-----
-----过了这条线我又要开始乱写了-----

好了下午过去的差不多了很久没有写这么多中文了很多词用的应该是完全不对的吧但是我不管了反正差不多就是这个意思了写的还是比较简单的如果有高手能指正一下的话最好不过了我关机做饭去了……
